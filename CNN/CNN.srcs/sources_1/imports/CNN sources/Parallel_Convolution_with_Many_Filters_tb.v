`timescale 1ns / 1ps
//test bench for average pool layer
module Parallel_Convolution_with_Many_Filters_tb;

parameter DATA_WIDTH=16;
parameter IMAGE_COLs=32;
parameter FILTER_COLs=5;
parameter NO_OF_FILTERs=2;
parameter OUTPUT_COLs=28;
parameter NO_OF_IMAGES=1;

reg clk, rst, start;
reg [0:(DATA_WIDTH*IMAGE_COLs*IMAGE_COLs*NO_OF_IMAGES)-1]image;
reg [0:(DATA_WIDTH*FILTER_COLs*FILTER_COLs*NO_OF_FILTERs)-1]filters;
wire [0:(DATA_WIDTH*OUTPUT_COLs*OUTPUT_COLs*NO_OF_FILTERs)-1]filtered_images;
wire finish;


//display variables
initial
$monitor ("clk = %b, rst = %b, start = %b, image = %h, filters = %h, filtered_images = %h, finish = %b", clk, rst, start, image, filters, filtered_images, finish);

//apply input vectors
initial
begin

    clk = 1'b0;	
    rst = 1'b1;

    #10 rst = 1'b0;
    start = 1'b1;
    image = 16384'h0000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000000010002000300040005000600070008000900000001000200030004000500060007000800090000000100020003000400050006000700080009000800080008000800;
    filters = 800'h10000000F0000000100010000000F0000000100010000000F0000000100010000000F0000000100010000000F0000000100010000000F0000000100010000000F0000000100010000000F0000000100010000000F0000000100010000000F00000001000;
        
    #10 start = 1'b0;

    #10 $stop;

end


always begin
  #5 clk = ~clk;
end

//instantiate the module into the test bench
Parallel_Convolution_with_Many_Filters inst1 (
.Clk(clk),
.Rst(rst),
.Start(start),
.image(image),
.filters(filters),
.filtered_images(filtered_images),
.Finish(finish)

);
endmodule